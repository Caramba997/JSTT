[
  {
    "url": "https://api.github.com/repos/eslint/eslint/issues/13931",
    "repository_url": "https://api.github.com/repos/eslint/eslint",
    "labels_url": "https://api.github.com/repos/eslint/eslint/issues/13931/labels{/name}",
    "comments_url": "https://api.github.com/repos/eslint/eslint/issues/13931/comments",
    "events_url": "https://api.github.com/repos/eslint/eslint/issues/13931/events",
    "html_url": "https://github.com/eslint/eslint/pull/13931",
    "id": 768498497,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NTQwOTI3Njkw",
    "number": 13931,
    "title": "Docs: Remove for deleted npm run profile script",
    "user": {
      "login": "btmills",
      "id": 1709537,
      "node_id": "MDQ6VXNlcjE3MDk1Mzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1709537?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/btmills",
      "html_url": "https://github.com/btmills",
      "followers_url": "https://api.github.com/users/btmills/followers",
      "following_url": "https://api.github.com/users/btmills/following{/other_user}",
      "gists_url": "https://api.github.com/users/btmills/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/btmills/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/btmills/subscriptions",
      "organizations_url": "https://api.github.com/users/btmills/orgs",
      "repos_url": "https://api.github.com/users/btmills/repos",
      "events_url": "https://api.github.com/users/btmills/events{/privacy}",
      "received_events_url": "https://api.github.com/users/btmills/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 64004798,
        "node_id": "MDU6TGFiZWw2NDAwNDc5OA==",
        "url": "https://api.github.com/repos/eslint/eslint/labels/documentation",
        "name": "documentation",
        "color": "5319e7",
        "default": true,
        "description": "Relates to ESLint's documentation"
      },
      {
        "id": 131106229,
        "node_id": "MDU6TGFiZWwxMzExMDYyMjk=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/accepted",
        "name": "accepted",
        "color": "0052cc",
        "default": false,
        "description": "There is consensus among the team that this change meets the criteria for inclusion"
      },
      {
        "id": 360091515,
        "node_id": "MDU6TGFiZWwzNjAwOTE1MTU=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/chore",
        "name": "chore",
        "color": "c2e0c6",
        "default": false,
        "description": "This change is not user-facing"
      },
      {
        "id": 829215248,
        "node_id": "MDU6TGFiZWw4MjkyMTUyNDg=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/archived%20due%20to%20age",
        "name": "archived due to age",
        "color": "eeeeee",
        "default": false,
        "description": "This issue has been archived; please open a new issue for any further discussion"
      }
    ],
    "state": "closed",
    "locked": true,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-12-16T06:31:07Z",
    "updated_at": "2021-06-17T11:48:59Z",
    "closed_at": "2020-12-18T04:52:34Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "draft": false,
    "pull_request": {
      "url": "https://api.github.com/repos/eslint/eslint/pulls/13931",
      "html_url": "https://github.com/eslint/eslint/pull/13931",
      "diff_url": "https://github.com/eslint/eslint/pull/13931.diff",
      "patch_url": "https://github.com/eslint/eslint/pull/13931.patch",
      "merged_at": "2020-12-18T04:52:34Z"
    },
    "body": "<!--\r\n    Thank you for contributing!\r\n\r\n    ESLint adheres to the [JS Foundation Code of Conduct](https://js.foundation/community/code-of-conduct).\r\n-->\r\n\r\n#### Prerequisites checklist\r\n\r\n- [x] I have read the [contributing guidelines](https://github.com/eslint/eslint/blob/master/CONTRIBUTING.md).\r\n\r\n#### What is the purpose of this pull request? (put an \"X\" next to an item)\r\n\r\n[x] Documentation update\r\n[ ] Bug fix ([template](https://raw.githubusercontent.com/eslint/eslint/master/templates/bug-report.md))\r\n[ ] New rule ([template](https://raw.githubusercontent.com/eslint/eslint/master/templates/rule-proposal.md))\r\n[ ] Changes an existing rule ([template](https://raw.githubusercontent.com/eslint/eslint/master/templates/rule-change-proposal.md))\r\n[ ] Add autofixing to a rule\r\n[ ] Add a CLI option\r\n[ ] Add something to the core\r\n[ ] Other, please explain:\r\n\r\n<!--\r\n    If the item you've checked above has a template, please paste the template questions below and answer them. (If this pull request is addressing an issue, you can just paste a link to the issue here instead.)\r\n-->\r\n\r\n<!--\r\n    Please ensure your pull request is ready:\r\n\r\n    - Read the pull request guide (https://eslint.org/docs/developer-guide/contributing/pull-requests)\r\n    - Include tests for this change\r\n    - Update documentation for this change (if appropriate)\r\n-->\r\n\r\n<!--\r\n    The following is required for all pull requests:\r\n-->\r\n\r\n#### What changes did you make? (Give an overview)\r\n\r\nThe `npm run profile` script was deleted in https://github.com/eslint/eslint/pull/11854 after it stopped working when we moved from Browserify to webpack. This commit removes the leftover docs and two of the three benchmark files. `large.js` is still used by a test case ensuring we can read > 4k data from stdin.\r\n\r\n#### Is there anything you'd like reviewers to focus on?\r\n\r\nI felt safe deleting the previous benchmark examples because if we eventually add in a new profile command, we'll likely want new examples anyway that contain more modern JS rather than just the ES5 examples we had before.",
    "reactions": {
      "url": "https://api.github.com/repos/eslint/eslint/issues/13931/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/eslint/eslint/issues/13931/timeline",
    "performed_via_github_app": null,
    "state_reason": null,
    "score": 1,
    "files": [
      {
        "sha": "8433bd04967c0377f87e28c6f48ab8fa268d43da",
        "filename": "docs/developer-guide/development-environment.md",
        "status": "modified",
        "additions": 0,
        "deletions": 15,
        "changes": 15,
        "blob_url": "https://github.com/eslint/eslint/blob/ee84555ae21f78cd0eb620736087c57698166381/docs%2Fdeveloper-guide%2Fdevelopment-environment.md",
        "raw_url": "https://github.com/eslint/eslint/raw/ee84555ae21f78cd0eb620736087c57698166381/docs%2Fdeveloper-guide%2Fdevelopment-environment.md",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/docs%2Fdeveloper-guide%2Fdevelopment-environment.md?ref=ee84555ae21f78cd0eb620736087c57698166381",
        "patch": "@@ -90,18 +90,3 @@ Generates `build/eslint.js`, a version of ESLint for use in the browser\n #### npm run docs\n \n Generates JSDoc documentation and places it into `/jsdoc`.\n-\n-#### npm run profile\n-\n-This command is used for intensive profiling of ESLint using Chrome Developer Tools. It starts a development server that runs through three profiles:\n-\n-* Large - Runs ESLint on JSHint\n-* Medium - Runs ESLint on jQuery\n-* Small - Runs ESLint on KnockoutJS\n-\n-Your browser should automatically open to the page in question. When that happens:\n-\n-1. Open up developer tools\n-1. Click on Profiles\n-\n-You should start to see profiles for each run show up on the left side. If not, reload the page in the browser. Once all three profiles have completed, they will be available for inspection."
      },
      {
        "sha": "ad97af7cefd0c7972879e69235cb5e47cb242020",
        "filename": "tests/bench/bench.js",
        "status": "removed",
        "additions": 0,
        "deletions": 38,
        "changes": 38,
        "blob_url": "https://github.com/eslint/eslint/blob/902a03219eca513a84457251ed53978a9e26fb4e/tests%2Fbench%2Fbench.js",
        "raw_url": "https://github.com/eslint/eslint/raw/902a03219eca513a84457251ed53978a9e26fb4e/tests%2Fbench%2Fbench.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Fbench.js?ref=902a03219eca513a84457251ed53978a9e26fb4e",
        "patch": "@@ -1,38 +0,0 @@\n-var Linter = require(\"../../lib/linter\").Linter,\n-    fs = require(\"fs\");\n-\n-var config = require(\"../../conf/eslint-recommended\");\n-\n-var large = fs.readFileSync(__dirname + \"/large.js\", \"utf8\"),\n-    medium = fs.readFileSync(__dirname + \"/medium.js\", \"utf8\"),\n-    small = fs.readFileSync(__dirname + \"/small.js\", \"utf8\");\n-\n-var runs = {\n-    large: large,\n-    medium: medium,\n-    small: small\n-};\n-var linter = new Linter();\n-\n-benchmark.runs = runs;\n-benchmark(Boolean, 1);\n-\n-function benchmark(grep, times) {\n-    console.profile(\"all\");\n-    for(var key in runs) {\n-        if(grep(key)) {\n-            console.time(key);\n-            console.profile(key);\n-            run(runs[key], times);\n-            console.profileEnd(key);\n-            console.timeEnd(key);\n-        }\n-    }\n-    console.profileEnd(\"all\");\n-}\n-\n-function run(content, times) {\n-    while(times--) {\n-        linter.verify(content, config);\n-    }\n-}"
      },
      {
        "sha": "3edf835fde4e83c9cf44b1264aa95655726823a8",
        "filename": "tests/bench/medium.js",
        "status": "removed",
        "additions": 0,
        "deletions": 9111,
        "changes": 9111,
        "blob_url": "https://github.com/eslint/eslint/blob/902a03219eca513a84457251ed53978a9e26fb4e/tests%2Fbench%2Fmedium.js",
        "raw_url": "https://github.com/eslint/eslint/raw/902a03219eca513a84457251ed53978a9e26fb4e/tests%2Fbench%2Fmedium.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Fmedium.js?ref=902a03219eca513a84457251ed53978a9e26fb4e"
      },
      {
        "sha": "d2cdf354652fe1327c945ae3d37d50fafb76202f",
        "filename": "tests/bench/small.js",
        "status": "removed",
        "additions": 0,
        "deletions": 4225,
        "changes": 4225,
        "blob_url": "https://github.com/eslint/eslint/blob/902a03219eca513a84457251ed53978a9e26fb4e/tests%2Fbench%2Fsmall.js",
        "raw_url": "https://github.com/eslint/eslint/raw/902a03219eca513a84457251ed53978a9e26fb4e/tests%2Fbench%2Fsmall.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Fsmall.js?ref=902a03219eca513a84457251ed53978a9e26fb4e"
      }
    ]
  },
  {
    "url": "https://api.github.com/repos/eslint/eslint/issues/11685",
    "repository_url": "https://api.github.com/repos/eslint/eslint",
    "labels_url": "https://api.github.com/repos/eslint/eslint/issues/11685/labels{/name}",
    "comments_url": "https://api.github.com/repos/eslint/eslint/issues/11685/comments",
    "events_url": "https://api.github.com/repos/eslint/eslint/issues/11685/events",
    "html_url": "https://github.com/eslint/eslint/pull/11685",
    "id": 441630462,
    "node_id": "MDExOlB1bGxSZXF1ZXN0Mjc2OTE1MDg0",
    "number": 11685,
    "title": "Fix: Unignoring directories in .eslintignore (fixes #11684)",
    "user": {
      "login": "belochub",
      "id": 3501391,
      "node_id": "MDQ6VXNlcjM1MDEzOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3501391?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/belochub",
      "html_url": "https://github.com/belochub",
      "followers_url": "https://api.github.com/users/belochub/followers",
      "following_url": "https://api.github.com/users/belochub/following{/other_user}",
      "gists_url": "https://api.github.com/users/belochub/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/belochub/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/belochub/subscriptions",
      "organizations_url": "https://api.github.com/users/belochub/orgs",
      "repos_url": "https://api.github.com/users/belochub/repos",
      "events_url": "https://api.github.com/users/belochub/events{/privacy}",
      "received_events_url": "https://api.github.com/users/belochub/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 45711350,
        "node_id": "MDU6TGFiZWw0NTcxMTM1MA==",
        "url": "https://api.github.com/repos/eslint/eslint/labels/bug",
        "name": "bug",
        "color": "fc2929",
        "default": true,
        "description": "ESLint is working incorrectly"
      },
      {
        "id": 82922548,
        "node_id": "MDU6TGFiZWw4MjkyMjU0OA==",
        "url": "https://api.github.com/repos/eslint/eslint/labels/core",
        "name": "core",
        "color": "c7def8",
        "default": false,
        "description": "Relates to ESLint's core APIs and features"
      },
      {
        "id": 131106229,
        "node_id": "MDU6TGFiZWwxMzExMDYyMjk=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/accepted",
        "name": "accepted",
        "color": "0052cc",
        "default": false,
        "description": "There is consensus among the team that this change meets the criteria for inclusion"
      },
      {
        "id": 829215248,
        "node_id": "MDU6TGFiZWw4MjkyMTUyNDg=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/archived%20due%20to%20age",
        "name": "archived due to age",
        "color": "eeeeee",
        "default": false,
        "description": "This issue has been archived; please open a new issue for any further discussion"
      }
    ],
    "state": "closed",
    "locked": true,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2019-05-08T09:10:03Z",
    "updated_at": "2019-11-15T22:43:42Z",
    "closed_at": "2019-05-18T07:49:53Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "draft": false,
    "pull_request": {
      "url": "https://api.github.com/repos/eslint/eslint/pulls/11685",
      "html_url": "https://github.com/eslint/eslint/pull/11685",
      "diff_url": "https://github.com/eslint/eslint/pull/11685.diff",
      "patch_url": "https://github.com/eslint/eslint/pull/11685.patch",
      "merged_at": "2019-05-18T07:49:53Z"
    },
    "body": "<!--\r\n    ESLint adheres to the [JS Foundation Code of Conduct](https://js.foundation/community/code-of-conduct).\r\n-->\r\n\r\n**What is the purpose of this pull request? (put an \"X\" next to item)**\r\n\r\n[ ] Documentation update\r\n[x] Bug fix ([template](https://raw.githubusercontent.com/eslint/eslint/master/templates/bug-report.md))\r\n[ ] New rule ([template](https://raw.githubusercontent.com/eslint/eslint/master/templates/rule-proposal.md))\r\n[ ] Changes an existing rule ([template](https://raw.githubusercontent.com/eslint/eslint/master/templates/rule-change-proposal.md))\r\n[ ] Add autofixing to a rule\r\n[ ] Add a CLI option\r\n[ ] Add something to the core\r\n[ ] Other, please explain:\r\n\r\n<!--\r\n    If the item you've checked above has a template, please paste the template questions below and answer them. (If this pull request is addressing an issue, you can just paste a link to the issue here instead.)\r\n-->\r\nhttps://github.com/eslint/eslint/issues/11684\r\n<!--\r\n    Please ensure your pull request is ready:\r\n\r\n    - Read the pull request guide (https://eslint.org/docs/developer-guide/contributing/pull-requests)\r\n    - Include tests for this change\r\n    - Update documentation for this change (if appropriate)\r\n-->\r\n\r\n<!--\r\n    The following is required for all pull requests:\r\n-->\r\n\r\n**What changes did you make? (Give an overview)**\r\n\r\nAs far as I understand the issue, the filtering of files/directories during globbing must pass absolute paths to the filtering function with the trailing slash present for directories to distinguish them from files, and the relative path extracted from the absolute path in this function must preserve the trailing slash as well since the relative path is passed to `ignore` package afterward, and it can not \"unignore\" directories that are \"marked\" as files (have no trailing slash).\r\n\r\n~~First of all, I've noticed that the `_mark()`ing in the overridden `GlobSync.prototype._readdir()` method didn't add the trailing slash to the path, IIUC due to the fact that it only uses cache to check if the path points to a directory and this cache is not created until the first call to the parent's `_readdir()` method, thus I've changed the order in which these methods are called.~~\r\n\r\n~~Secondly, I've changed the `getRelativePath()` function's behavior to preserve the trailing slash.~~\r\n\r\n**Is there anything you'd like reviewers to focus on?**\r\n\r\n~~The change to the `getRelativePath()` function is also related to the `IgnoredPaths.prototype.getIgnoredFoldersGlobChecker()` method's behavior and changes it implicitly.~~\r\n\r\n~~Also, even though paths are cached inside the `glob.GlobSync` instance, I am not sure if this does not significantly degrade the performance of globbing, I would like to get some help with the benchmarking of this change.~~\r\n\r\nEDIT: Some parts of the description above are no longer relevant after https://github.com/eslint/eslint/pull/11546 has landed.",
    "reactions": {
      "url": "https://api.github.com/repos/eslint/eslint/issues/11685/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/eslint/eslint/issues/11685/timeline",
    "performed_via_github_app": null,
    "state_reason": null,
    "score": 1,
    "files": [
      {
        "sha": "2cb0fc6ea457b8cb7d91b0998c15bf02a7bd24b2",
        "filename": "lib/cli-engine/file-enumerator.js",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/eslint/eslint/blob/8f2911037dba41e1faedd99ac7d583f2fac0cc49/lib%2Fcli-engine%2Ffile-enumerator.js",
        "raw_url": "https://github.com/eslint/eslint/raw/8f2911037dba41e1faedd99ac7d583f2fac0cc49/lib%2Fcli-engine%2Ffile-enumerator.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/lib%2Fcli-engine%2Ffile-enumerator.js?ref=8f2911037dba41e1faedd99ac7d583f2fac0cc49",
        "patch": "@@ -380,7 +380,7 @@ class FileEnumerator {\n      * @private\n      */\n     *_iterateFilesRecursive(directoryPath, options) {\n-        if (this._isIgnoredFile(directoryPath, options)) {\n+        if (this._isIgnoredFile(directoryPath + path.sep, options)) {\n             return;\n         }\n         debug(`Enter the directory: ${directoryPath}`);"
      },
      {
        "sha": "137d156e9c05af9d286a491005b8a6fded645aed",
        "filename": "lib/util/ignored-paths.js",
        "status": "modified",
        "additions": 6,
        "deletions": 1,
        "changes": 7,
        "blob_url": "https://github.com/eslint/eslint/blob/8f2911037dba41e1faedd99ac7d583f2fac0cc49/lib%2Futil%2Fignored-paths.js",
        "raw_url": "https://github.com/eslint/eslint/raw/8f2911037dba41e1faedd99ac7d583f2fac0cc49/lib%2Futil%2Fignored-paths.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/lib%2Futil%2Fignored-paths.js?ref=8f2911037dba41e1faedd99ac7d583f2fac0cc49",
        "patch": "@@ -328,12 +328,17 @@ class IgnoredPaths {\n      * @returns {boolean} true if the file path matches one or more patterns, false otherwise\n      */\n     contains(filepath, category) {\n+        const isDir = filepath.endsWith(path.sep) ||\n+            (path.sep === \"\\\\\" && filepath.endsWith(\"/\"));\n         let result = false;\n         const basePath = this.getBaseDir();\n         const absolutePath = path.resolve(this.options.cwd, filepath);\n-        const relativePath = path.relative(basePath, absolutePath);\n+        let relativePath = path.relative(basePath, absolutePath);\n \n         if (relativePath) {\n+            if (isDir) {\n+                relativePath += path.sep;\n+            }\n             if (typeof category === \"undefined\") {\n                 result =\n                     (this.ig.default.filter([relativePath]).length === 0) ||"
      },
      {
        "sha": "d1c26dcc88cce5ae147584df394bef0f65bfd292",
        "filename": "tests/fixtures/glob-util/unignored/.eslintignore",
        "status": "added",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/eslint/eslint/blob/8f2911037dba41e1faedd99ac7d583f2fac0cc49/tests%2Ffixtures%2Fglob-util%2Funignored%2F.eslintignore",
        "raw_url": "https://github.com/eslint/eslint/raw/8f2911037dba41e1faedd99ac7d583f2fac0cc49/tests%2Ffixtures%2Fglob-util%2Funignored%2F.eslintignore",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Ffixtures%2Fglob-util%2Funignored%2F.eslintignore?ref=8f2911037dba41e1faedd99ac7d583f2fac0cc49",
        "patch": "@@ -0,0 +1,3 @@\n+*\n+!/dir/\n+!*.js"
      },
      {
        "sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391",
        "filename": "tests/fixtures/glob-util/unignored/dir/foo.js",
        "status": "added",
        "additions": 0,
        "deletions": 0,
        "changes": 0,
        "blob_url": "https://github.com/eslint/eslint/blob/8f2911037dba41e1faedd99ac7d583f2fac0cc49/tests%2Ffixtures%2Fglob-util%2Funignored%2Fdir%2Ffoo.js",
        "raw_url": "https://github.com/eslint/eslint/raw/8f2911037dba41e1faedd99ac7d583f2fac0cc49/tests%2Ffixtures%2Fglob-util%2Funignored%2Fdir%2Ffoo.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Ffixtures%2Fglob-util%2Funignored%2Fdir%2Ffoo.js?ref=8f2911037dba41e1faedd99ac7d583f2fac0cc49"
      },
      {
        "sha": "23a21c0b7446910108a62d29f1a20f8e389d099b",
        "filename": "tests/lib/cli-engine/file-enumerator.js",
        "status": "modified",
        "additions": 24,
        "deletions": 0,
        "changes": 24,
        "blob_url": "https://github.com/eslint/eslint/blob/8f2911037dba41e1faedd99ac7d583f2fac0cc49/tests%2Flib%2Fcli-engine%2Ffile-enumerator.js",
        "raw_url": "https://github.com/eslint/eslint/raw/8f2911037dba41e1faedd99ac7d583f2fac0cc49/tests%2Flib%2Fcli-engine%2Ffile-enumerator.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Flib%2Fcli-engine%2Ffile-enumerator.js?ref=8f2911037dba41e1faedd99ac7d583f2fac0cc49",
        "patch": "@@ -448,6 +448,30 @@ describe(\"FileEnumerator\", () => {\n \n                     assert.includeDeepMembers(result, [{ filename: unignoredFilename, ignored: false }]);\n                 });\n+\n+                it(\"should return unignored files from folders unignored in .eslintignore\", () => {\n+                    const options = { cwd: getFixturePath(\"glob-util\", \"unignored\"), ignore: true };\n+                    const glob = getFixturePath(\"glob-util\", \"unignored\", \"**/*.js\");\n+                    const patterns = [glob];\n+                    const result = listFiles(patterns, options);\n+\n+                    const filename = getFixturePath(\"glob-util\", \"unignored\", \"dir\", \"foo.js\");\n+\n+                    assert.strictEqual(result.length, 1);\n+                    assert.deepStrictEqual(result, [{ filename, ignored: false }]);\n+                });\n+\n+                it(\"should return unignored files from folders unignored in .eslintignore for explicitly specified folder\", () => {\n+                    const options = { cwd: getFixturePath(\"glob-util\", \"unignored\"), ignore: true };\n+                    const dir = getFixturePath(\"glob-util\", \"unignored\", \"dir\");\n+                    const patterns = [dir];\n+                    const result = listFiles(patterns, options);\n+\n+                    const filename = getFixturePath(\"glob-util\", \"unignored\", \"dir\", \"foo.js\");\n+\n+                    assert.strictEqual(result.length, 1);\n+                    assert.deepStrictEqual(result, [{ filename, ignored: false }]);\n+                });\n             });\n         });\n     });"
      }
    ]
  },
  {
    "url": "https://api.github.com/repos/eslint/eslint/issues/9455",
    "repository_url": "https://api.github.com/repos/eslint/eslint",
    "labels_url": "https://api.github.com/repos/eslint/eslint/issues/9455/labels{/name}",
    "comments_url": "https://api.github.com/repos/eslint/eslint/issues/9455/comments",
    "events_url": "https://api.github.com/repos/eslint/eslint/issues/9455/events",
    "html_url": "https://github.com/eslint/eslint/pull/9455",
    "id": 265665621,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MTQ2NzA5Nzkw",
    "number": 9455,
    "title": "Build: fix `npm run profile` script (fixes #9397)",
    "user": {
      "login": "not-an-aardvark",
      "id": 11638619,
      "node_id": "MDQ6VXNlcjExNjM4NjE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/11638619?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/not-an-aardvark",
      "html_url": "https://github.com/not-an-aardvark",
      "followers_url": "https://api.github.com/users/not-an-aardvark/followers",
      "following_url": "https://api.github.com/users/not-an-aardvark/following{/other_user}",
      "gists_url": "https://api.github.com/users/not-an-aardvark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/not-an-aardvark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/not-an-aardvark/subscriptions",
      "organizations_url": "https://api.github.com/users/not-an-aardvark/orgs",
      "repos_url": "https://api.github.com/users/not-an-aardvark/repos",
      "events_url": "https://api.github.com/users/not-an-aardvark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/not-an-aardvark/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 45711350,
        "node_id": "MDU6TGFiZWw0NTcxMTM1MA==",
        "url": "https://api.github.com/repos/eslint/eslint/labels/bug",
        "name": "bug",
        "color": "fc2929",
        "default": true,
        "description": "ESLint is working incorrectly"
      },
      {
        "id": 72921735,
        "node_id": "MDU6TGFiZWw3MjkyMTczNQ==",
        "url": "https://api.github.com/repos/eslint/eslint/labels/build",
        "name": "build",
        "color": "fad8c7",
        "default": false,
        "description": "This change relates to ESLint's build process"
      },
      {
        "id": 131106229,
        "node_id": "MDU6TGFiZWwxMzExMDYyMjk=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/accepted",
        "name": "accepted",
        "color": "0052cc",
        "default": false,
        "description": "There is consensus among the team that this change meets the criteria for inclusion"
      },
      {
        "id": 829215248,
        "node_id": "MDU6TGFiZWw4MjkyMTUyNDg=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/archived%20due%20to%20age",
        "name": "archived due to age",
        "color": "eeeeee",
        "default": false,
        "description": "This issue has been archived; please open a new issue for any further discussion"
      }
    ],
    "state": "closed",
    "locked": true,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2017-10-16T07:04:43Z",
    "updated_at": "2018-04-15T19:20:26Z",
    "closed_at": "2017-10-16T15:17:50Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "draft": false,
    "pull_request": {
      "url": "https://api.github.com/repos/eslint/eslint/pulls/9455",
      "html_url": "https://github.com/eslint/eslint/pull/9455",
      "diff_url": "https://github.com/eslint/eslint/pull/9455.diff",
      "patch_url": "https://github.com/eslint/eslint/pull/9455.patch",
      "merged_at": "2017-10-16T15:17:50Z"
    },
    "body": "<!--\r\n    ESLint adheres to the [JS Foundation Code of Conduct](https://js.foundation/community/code-of-conduct).\r\n-->\r\n\r\n**What is the purpose of this pull request? (put an \"X\" next to item)**\r\n\r\n[x] Bug fix (https://github.com/eslint/eslint/issues/9397)\r\n\r\n<!--\r\n    If the item you've checked above has a template, please paste the template questions below and answer them. (If this pull request is addressing an issue, you can just paste a link to the issue here instead.)\r\n-->\r\n\r\n<!--\r\n    Please ensure your pull request is ready:\r\n\r\n    - Read the pull request guide (https://eslint.org/docs/developer-guide/contributing/pull-requests)\r\n    - Include tests for this change\r\n    - Update documentation for this change (if appropriate)\r\n-->\r\n\r\n<!--\r\n    The following is required for all pull requests:\r\n-->\r\n\r\n**What changes did you make? (Give an overview)**\r\n\r\nThis fixes the `npm run profile` script in the repository.\r\n\r\nThis is actually the first time I've tried to use the script, and I'm not very familiar with the design goals (e.g. I'm not sure why it runs the benchmark in chrome rather than Node). I think having a benchmark for `Linter` is a good idea -- if we decide to keep using this, we might want to convert it to ES6 and add tests for it.\r\n\r\n**Is there anything you'd like reviewers to focus on?**\r\n\r\nNothing in particular",
    "reactions": {
      "url": "https://api.github.com/repos/eslint/eslint/issues/9455/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/eslint/eslint/issues/9455/timeline",
    "performed_via_github_app": null,
    "state_reason": null,
    "score": 1,
    "files": [
      {
        "sha": "be574cf336a76d310a4ae32e972d51e805fa8e94",
        "filename": "tests/bench/bench.js",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/eslint/eslint/blob/cab881c1edfa004fe501067c65106ac4843645ec/tests%2Fbench%2Fbench.js",
        "raw_url": "https://github.com/eslint/eslint/raw/cab881c1edfa004fe501067c65106ac4843645ec/tests%2Fbench%2Fbench.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Fbench.js?ref=cab881c1edfa004fe501067c65106ac4843645ec",
        "patch": "@@ -33,7 +33,6 @@ function benchmark(grep, times) {\n \n function run(content, times) {\n     while(times--) {\n-        linter.reset();\n         linter.verify(content, config);\n     }\n }"
      },
      {
        "sha": "9456f3258cc0aecfc4d9e9aa348804f58ce49bef",
        "filename": "tests/bench/xform-rules.js",
        "status": "modified",
        "additions": 9,
        "deletions": 5,
        "changes": 14,
        "blob_url": "https://github.com/eslint/eslint/blob/cab881c1edfa004fe501067c65106ac4843645ec/tests%2Fbench%2Fxform-rules.js",
        "raw_url": "https://github.com/eslint/eslint/raw/cab881c1edfa004fe501067c65106ac4843645ec/tests%2Fbench%2Fxform-rules.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Fxform-rules.js?ref=cab881c1edfa004fe501067c65106ac4843645ec",
        "patch": "@@ -3,7 +3,7 @@ module.exports = transform;\n var fs = require(\"fs\"),\n     path = require(\"path\"),\n     through = require(\"through\");\n-    \n+\n var target = path.resolve(__dirname, \"..\", \"..\", \"lib\", \"load-rules.js\");\n \n \n@@ -23,10 +23,14 @@ function inject() {\n     var output = \"module.exports = function() {\\n\";\n     output += \"    var rules = Object.create(null);\\n\";\n \n-    fs.readdirSync(path.resolve(__dirname, \"..\", \"..\", \"lib\", \"rules\")).forEach(function(filename) {\n-        var basename = path.basename(filename, \".js\");\n-        output += \"    rules[\\\"\" + basename + \"\\\"] = require(\\\"./rules/\" + basename + \"\\\");\\n\";\n-    });\n+    fs.readdirSync(path.resolve(__dirname, \"..\", \"..\", \"lib\", \"rules\"))\n+        .filter(function(filename) {\n+            return filename.endsWith(\".js\");\n+        })\n+        .forEach(function(filename) {\n+            var basename = path.basename(filename, \".js\");\n+            output += \"    rules[\\\"\" + basename + \"\\\"] = require(\\\"./rules/\" + basename + \"\\\");\\n\";\n+        });\n \n     output += \"\\n    return rules;\\n};\";\n "
      }
    ]
  },
  {
    "url": "https://api.github.com/repos/eslint/eslint/issues/9283",
    "repository_url": "https://api.github.com/repos/eslint/eslint",
    "labels_url": "https://api.github.com/repos/eslint/eslint/issues/9283/labels{/name}",
    "comments_url": "https://api.github.com/repos/eslint/eslint/issues/9283/comments",
    "events_url": "https://api.github.com/repos/eslint/eslint/issues/9283/events",
    "html_url": "https://github.com/eslint/eslint/pull/9283",
    "id": 256545755,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MTQwMjI4NTYz",
    "number": 9283,
    "title": "Update: run rules after `node.parent` is already set (fixes #9122)",
    "user": {
      "login": "not-an-aardvark",
      "id": 11638619,
      "node_id": "MDQ6VXNlcjExNjM4NjE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/11638619?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/not-an-aardvark",
      "html_url": "https://github.com/not-an-aardvark",
      "followers_url": "https://api.github.com/users/not-an-aardvark/followers",
      "following_url": "https://api.github.com/users/not-an-aardvark/following{/other_user}",
      "gists_url": "https://api.github.com/users/not-an-aardvark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/not-an-aardvark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/not-an-aardvark/subscriptions",
      "organizations_url": "https://api.github.com/users/not-an-aardvark/orgs",
      "repos_url": "https://api.github.com/users/not-an-aardvark/repos",
      "events_url": "https://api.github.com/users/not-an-aardvark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/not-an-aardvark/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 45711352,
        "node_id": "MDU6TGFiZWw0NTcxMTM1Mg==",
        "url": "https://api.github.com/repos/eslint/eslint/labels/enhancement",
        "name": "enhancement",
        "color": "84b6eb",
        "default": true,
        "description": "This change enhances an existing feature of ESLint"
      },
      {
        "id": 82922548,
        "node_id": "MDU6TGFiZWw4MjkyMjU0OA==",
        "url": "https://api.github.com/repos/eslint/eslint/labels/core",
        "name": "core",
        "color": "c7def8",
        "default": false,
        "description": "Relates to ESLint's core APIs and features"
      },
      {
        "id": 131106229,
        "node_id": "MDU6TGFiZWwxMzExMDYyMjk=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/accepted",
        "name": "accepted",
        "color": "0052cc",
        "default": false,
        "description": "There is consensus among the team that this change meets the criteria for inclusion"
      },
      {
        "id": 829215248,
        "node_id": "MDU6TGFiZWw4MjkyMTUyNDg=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/archived%20due%20to%20age",
        "name": "archived due to age",
        "color": "eeeeee",
        "default": false,
        "description": "This issue has been archived; please open a new issue for any further discussion"
      }
    ],
    "state": "closed",
    "locked": true,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2017-09-10T22:37:42Z",
    "updated_at": "2018-03-15T06:10:38Z",
    "closed_at": "2017-09-15T19:26:02Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "draft": false,
    "pull_request": {
      "url": "https://api.github.com/repos/eslint/eslint/pulls/9283",
      "html_url": "https://github.com/eslint/eslint/pull/9283",
      "diff_url": "https://github.com/eslint/eslint/pull/9283.diff",
      "patch_url": "https://github.com/eslint/eslint/pull/9283.patch",
      "merged_at": "2017-09-15T19:26:02Z"
    },
    "body": "<!--\r\n    ESLint adheres to the [JS Foundation Code of Conduct](https://js.foundation/community/code-of-conduct).\r\n-->\r\n\r\n**What is the purpose of this pull request? (put an \"X\" next to item)**\r\n\r\n[x] Add something to the core\r\n\r\n<!--\r\n    If the item you've checked above has a template, please paste the template questions below and answer them. (If this pull request is addressing an issue, you can just paste a link to the issue here instead.)\r\n-->\r\n\r\n<!--\r\n    Please ensure your pull request is ready:\r\n\r\n    - Read the pull request guide (http://eslint.org/docs/developer-guide/contributing/pull-requests)\r\n    - Include tests for this change\r\n    - Update documentation for this change (if appropriate)\r\n-->\r\n\r\n<!--\r\n    The following is required for all pull requests:\r\n-->\r\n\r\n**What changes did you make? (Give an overview)**\r\n\r\nThis is a reference implementation of #9122. With this change, rules don't have to worry about whether `node.parent` has been set at any given point, because all of the `node.parent` properties will be assigned by the time the rule gets run.\r\n\r\n~~This builds on https://github.com/eslint/eslint/pull/9268, and should not be merged until https://github.com/eslint/eslint/pull/9268 is merged. For now, only look at the [second commit](https://github.com/eslint/eslint/pull/9283/commits/f65fdac1b0f8962cd44a899a4c6cf1a10e852fbf).~~\r\n\r\nSince this stores nodes in a queue rather than doing another traversal, this has very little performance impact:\r\n\r\n<details>\r\n<summary>Performance metrics</summary>\r\n\r\nOn 9ecd264 (without this change applied):\r\n\r\n```\r\n((HEAD detached at 7685fed3))$ npm run perf\r\n\r\n> eslint@4.6.1 perf /path/to/eslint\r\n> node Makefile.js perf\r\n\r\n\r\nLoading:\r\n  Load performance Run #1:  120.599158ms\r\n  Load performance Run #2:  114.98305ms\r\n  Load performance Run #3:  114.749014ms\r\n  Load performance Run #4:  119.581881ms\r\n  Load performance Run #5:  120.72974ms\r\n\r\n  Load Performance median:  119.581881ms\r\n\r\n\r\nSingle File:\r\n  CPU Speed is 3100 with multiplier 13000000\r\n  Performance Run #1:  5545.881914ms\r\n  Performance Run #2:  5494.320288ms\r\n  Performance Run #3:  5507.513848ms\r\n  Performance Run #4:  5535.386212ms\r\n  Performance Run #5:  5487.6923289999995ms\r\n\r\n  Performance budget exceeded: 5507.513848ms (limit: 4193.548387096775ms)\r\n\r\n\r\nMulti Files (0 files):\r\n  CPU Speed is 3100 with multiplier 39000000\r\n  Performance Run #1:  13472.871353ms\r\n  Performance Run #2:  13794.571958ms\r\n  Performance Run #3:  13790.013038000001ms\r\n  Performance Run #4:  13667.251705ms\r\n  Performance Run #5:  13450.531616ms\r\n\r\n  Performance budget exceeded: 13667.251705ms (limit: 12580.645161290322ms)\r\n```\r\n\r\nOn `deferred-listener-calls` (with this change applied):\r\n\r\n```\r\n(deferred-listener-calls)$ npm run perf\r\n\r\n> eslint@4.6.1 perf /Users/tkatz/code/eslint\r\n> node Makefile.js perf\r\n\r\n\r\nLoading:\r\n  Load performance Run #1:  116.02172ms\r\n  Load performance Run #2:  122.795839ms\r\n  Load performance Run #3:  120.586319ms\r\n  Load performance Run #4:  117.875192ms\r\n  Load performance Run #5:  117.937884ms\r\n\r\n  Load Performance median:  117.937884ms\r\n\r\n\r\nSingle File:\r\n  CPU Speed is 3100 with multiplier 13000000\r\n  Performance Run #1:  5591.12559ms\r\n  Performance Run #2:  5558.3983530000005ms\r\n  Performance Run #3:  5500.023409ms\r\n  Performance Run #4:  5587.691358ms\r\n  Performance Run #5:  5585.687514ms\r\n\r\n  Performance budget exceeded: 5585.687514ms (limit: 4193.548387096775ms)\r\n\r\n\r\nMulti Files (0 files):\r\n  CPU Speed is 3100 with multiplier 39000000\r\n  Performance Run #1:  13529.686102ms\r\n  Performance Run #2:  13508.945281ms\r\n  Performance Run #3:  13482.570723ms\r\n  Performance Run #4:  13340.607641ms\r\n  Performance Run #5:  13524.828015ms\r\n\r\n  Performance budget exceeded: 13508.945281ms (limit: 12580.645161290322ms)\r\n```\r\n\r\nThese numbers indicate a 1% performance decrease on the single-file benchmark, and a 1% improvement on the multi-file benchmark. I suspect at least some of this is noise, but if there is a performance impact it seems quite small.\r\n\r\n**Is there anything you'd like reviewers to focus on?**\r\n\r\nNothing in particular",
    "reactions": {
      "url": "https://api.github.com/repos/eslint/eslint/issues/9283/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/eslint/eslint/issues/9283/timeline",
    "performed_via_github_app": null,
    "state_reason": null,
    "score": 1,
    "files": [
      {
        "sha": "c9315bf12498dbfb9cb22642c48823fc2906374f",
        "filename": "docs/developer-guide/working-with-plugins.md",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/eslint/eslint/blob/5aeed11d87c2b67ab72187a5a62d1b977e28e149/docs%2Fdeveloper-guide%2Fworking-with-plugins.md",
        "raw_url": "https://github.com/eslint/eslint/raw/5aeed11d87c2b67ab72187a5a62d1b977e28e149/docs%2Fdeveloper-guide%2Fworking-with-plugins.md",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/docs%2Fdeveloper-guide%2Fworking-with-plugins.md?ref=5aeed11d87c2b67ab72187a5a62d1b977e28e149",
        "patch": "@@ -174,7 +174,7 @@ All nodes must have `range` property.\n * `range` (`number[]`) is an array of two numbers. Both numbers are a 0-based index which is the position in the array of source code characters. The first is the start position of the node, the second is the end position of the node. `code.slice(node.range[0], node.range[1])` must be the text of the node. This range does not include spaces/parentheses which are around the node.\n * `loc` (`SourceLocation`) must not be `null`. [The `loc` property is defined as nullable by ESTree](https://github.com/estree/estree/blob/25834f7247d44d3156030f8e8a2d07644d771fdb/es5.md#node-objects), but ESLint requires this property. On the other hand, `SourceLocation#source` property can be `undefined`. ESLint does not use the `SourceLocation#source` property.\n \n-The `parent` property of all nodes must be rewriteable. ESLint sets each node's parent properties to its parent node while traversing.\n+The `parent` property of all nodes must be rewriteable. ESLint sets each node's `parent` property to its parent node while traversing, before any rules have access to the AST.\n \n #### The `Program` node:\n "
      },
      {
        "sha": "328f8124b81b2dfe46d89c7fe605be60770fe858",
        "filename": "lib/linter.js",
        "status": "modified",
        "additions": 39,
        "deletions": 17,
        "changes": 56,
        "blob_url": "https://github.com/eslint/eslint/blob/5aeed11d87c2b67ab72187a5a62d1b977e28e149/lib%2Flinter.js",
        "raw_url": "https://github.com/eslint/eslint/raw/5aeed11d87c2b67ab72187a5a62d1b977e28e149/lib%2Flinter.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/lib%2Flinter.js?ref=5aeed11d87c2b67ab72187a5a62d1b977e28e149",
        "patch": "@@ -653,6 +653,22 @@ function markVariableAsUsed(scopeManager, currentNode, parserOptions, name) {\n     return false;\n }\n \n+/**\n+ * Gets all the ancestors of a given node\n+ * @param {ASTNode} node The node\n+ * @returns {ASTNode[]} All the ancestor nodes in the AST, not including the provided node, starting\n+ * from the root node and going inwards to the parent node.\n+ */\n+function getAncestors(node) {\n+    if (node.parent) {\n+        const parentAncestors = getAncestors(node.parent);\n+\n+        parentAncestors.push(node.parent);\n+        return parentAncestors;\n+    }\n+    return [];\n+}\n+\n // methods that exist on SourceCode object\n const DEPRECATED_SOURCECODE_PASSTHROUGHS = {\n     getSource: \"getText\",\n@@ -812,7 +828,6 @@ module.exports = class Linter {\n         }\n \n         const emitter = new EventEmitter().setMaxListeners(Infinity);\n-        const traverser = new Traverser();\n         const ecmaFeatures = config.parserOptions.ecmaFeatures || {};\n         const ecmaVersion = config.parserOptions.ecmaVersion || 5;\n         const scopeManager = eslintScope.analyze(sourceCode.ast, {\n@@ -824,6 +839,19 @@ module.exports = class Linter {\n             fallback: Traverser.getKeys\n         });\n \n+        let currentNode = sourceCode.ast;\n+        const nodeQueue = [];\n+\n+        new Traverser().traverse(sourceCode.ast, {\n+            enter(node, parent) {\n+                node.parent = parent;\n+                nodeQueue.push({ isEntering: true, node });\n+            },\n+            leave(node) {\n+                nodeQueue.push({ isEntering: false, node });\n+            }\n+        });\n+\n         /*\n          * Create a frozen object with the ruleContext properties and methods that are shared by all rules.\n          * All rule contexts will inherit from this object. This avoids the performance penalty of copying all the\n@@ -833,12 +861,12 @@ module.exports = class Linter {\n             Object.assign(\n                 Object.create(BASE_TRAVERSAL_CONTEXT),\n                 {\n-                    getAncestors: () => traverser.parents(),\n+                    getAncestors: () => getAncestors(currentNode),\n                     getDeclaredVariables: scopeManager.getDeclaredVariables.bind(scopeManager),\n                     getFilename: () => filename,\n-                    getScope: () => getScope(scopeManager, traverser.current(), config.parserOptions.ecmaVersion),\n+                    getScope: () => getScope(scopeManager, currentNode, config.parserOptions.ecmaVersion),\n                     getSourceCode: () => sourceCode,\n-                    markVariableAsUsed: name => markVariableAsUsed(scopeManager, traverser.current(), config.parserOptions, name),\n+                    markVariableAsUsed: name => markVariableAsUsed(scopeManager, currentNode, config.parserOptions, name),\n                     parserOptions: config.parserOptions,\n                     parserPath: config.parser,\n                     parserServices,\n@@ -943,19 +971,13 @@ module.exports = class Linter {\n \n         const eventGenerator = new CodePathAnalyzer(new NodeEventGenerator(emitter));\n \n-        /*\n-         * Each node has a type property. Whenever a particular type of\n-         * node is found, an event is fired. This allows any listeners to\n-         * automatically be informed that this type of node has been found\n-         * and react accordingly.\n-         */\n-        traverser.traverse(sourceCode.ast, {\n-            enter(node, parent) {\n-                node.parent = parent;\n-                eventGenerator.enterNode(node);\n-            },\n-            leave(node) {\n-                eventGenerator.leaveNode(node);\n+        nodeQueue.forEach(traversalInfo => {\n+            currentNode = traversalInfo.node;\n+\n+            if (traversalInfo.isEntering) {\n+                eventGenerator.enterNode(currentNode);\n+            } else {\n+                eventGenerator.leaveNode(currentNode);\n             }\n         });\n "
      },
      {
        "sha": "1c6620ed7351631def50be82ccb927e90b3a8cdd",
        "filename": "lib/util/source-code.js",
        "status": "modified",
        "additions": 3,
        "deletions": 5,
        "changes": 8,
        "blob_url": "https://github.com/eslint/eslint/blob/5aeed11d87c2b67ab72187a5a62d1b977e28e149/lib%2Futil%2Fsource-code.js",
        "raw_url": "https://github.com/eslint/eslint/raw/5aeed11d87c2b67ab72187a5a62d1b977e28e149/lib%2Futil%2Fsource-code.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/lib%2Futil%2Fsource-code.js?ref=5aeed11d87c2b67ab72187a5a62d1b977e28e149",
        "patch": "@@ -349,15 +349,13 @@ class SourceCode extends TokenStore {\n      * @returns {ASTNode} The node if found or null if not found.\n      */\n     getNodeByRangeIndex(index) {\n-        let result = null,\n-            resultParent = null;\n+        let result = null;\n         const traverser = new Traverser();\n \n         traverser.traverse(this.ast, {\n-            enter(node, parent) {\n+            enter(node) {\n                 if (node.range[0] <= index && index < node.range[1]) {\n                     result = node;\n-                    resultParent = parent;\n                 } else {\n                     this.skip();\n                 }\n@@ -369,7 +367,7 @@ class SourceCode extends TokenStore {\n             }\n         });\n \n-        return result ? Object.assign({ parent: resultParent }, result) : null;\n+        return result;\n     }\n \n     /**"
      },
      {
        "sha": "53cb94a9f03cf413403a2f0f83bec26e30ea2adc",
        "filename": "tests/lib/linter.js",
        "status": "modified",
        "additions": 15,
        "deletions": 37,
        "changes": 52,
        "blob_url": "https://github.com/eslint/eslint/blob/5aeed11d87c2b67ab72187a5a62d1b977e28e149/tests%2Flib%2Flinter.js",
        "raw_url": "https://github.com/eslint/eslint/raw/5aeed11d87c2b67ab72187a5a62d1b977e28e149/tests%2Flib%2Flinter.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Flib%2Flinter.js?ref=5aeed11d87c2b67ab72187a5a62d1b977e28e149",
        "patch": "@@ -100,6 +100,21 @@ describe(\"Linter\", () => {\n                 linter.verify(code, config, filename, true);\n             }, \"Intentional error.\");\n         });\n+\n+        it(\"has all the `parent` properties on nodes when the rule listeners are created\", () => {\n+            linter.defineRule(\"checker\", context => {\n+                const ast = context.getSourceCode().ast;\n+\n+                assert.strictEqual(ast.body[0].parent, ast);\n+                assert.strictEqual(ast.body[0].expression.parent, ast.body[0]);\n+                assert.strictEqual(ast.body[0].expression.left.parent, ast.body[0].expression);\n+                assert.strictEqual(ast.body[0].expression.right.parent, ast.body[0].expression);\n+\n+                return {};\n+            });\n+\n+            linter.verify(\"foo + bar\", { rules: { checker: \"error\" } });\n+        });\n     });\n \n     describe(\"context.getSourceLines()\", () => {\n@@ -432,43 +447,6 @@ describe(\"Linter\", () => {\n             linter.verify(code, config);\n             assert(spy.calledOnce);\n         });\n-\n-        it(\"should attach the node's parent\", () => {\n-            const config = { rules: { checker: \"error\" } };\n-            const spy = sandbox.spy(context => {\n-                const node = context.getNodeByRangeIndex(14);\n-\n-                assert.property(node, \"parent\");\n-                assert.equal(node.parent.type, \"VariableDeclarator\");\n-                return {};\n-            });\n-\n-            linter.defineRule(\"checker\", spy);\n-            linter.verify(code, config);\n-            assert(spy.calledOnce);\n-        });\n-\n-        it(\"should not modify the node when attaching the parent\", () => {\n-            const config = { rules: { checker: \"error\" } };\n-            const spy = sandbox.spy(context => {\n-                const node1 = context.getNodeByRangeIndex(10);\n-\n-                assert.equal(node1.type, \"VariableDeclarator\");\n-\n-                const node2 = context.getNodeByRangeIndex(4);\n-\n-                assert.equal(node2.type, \"Identifier\");\n-                assert.property(node2, \"parent\");\n-                assert.equal(node2.parent.type, \"VariableDeclarator\");\n-                assert.notProperty(node2.parent, \"parent\");\n-                return {};\n-            });\n-\n-            linter.defineRule(\"checker\", spy);\n-            linter.verify(code, config);\n-            assert(spy.calledOnce);\n-        });\n-\n     });\n \n "
      },
      {
        "sha": "b902bd2a151637b8326486aecd3aeab0093d215b",
        "filename": "tests/lib/util/source-code.js",
        "status": "modified",
        "additions": 0,
        "deletions": 19,
        "changes": 19,
        "blob_url": "https://github.com/eslint/eslint/blob/5aeed11d87c2b67ab72187a5a62d1b977e28e149/tests%2Flib%2Futil%2Fsource-code.js",
        "raw_url": "https://github.com/eslint/eslint/raw/5aeed11d87c2b67ab72187a5a62d1b977e28e149/tests%2Flib%2Futil%2Fsource-code.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Flib%2Futil%2Fsource-code.js?ref=5aeed11d87c2b67ab72187a5a62d1b977e28e149",
        "patch": "@@ -1775,25 +1775,6 @@ describe(\"SourceCode\", () => {\n             node = sourceCode.getNodeByRangeIndex(-99);\n             assert.isNull(node);\n         });\n-\n-        it(\"should attach the node's parent\", () => {\n-            const node = sourceCode.getNodeByRangeIndex(14);\n-\n-            assert.property(node, \"parent\");\n-            assert.equal(node.parent.type, \"VariableDeclarator\");\n-        });\n-\n-        it(\"should not modify the node when attaching the parent\", () => {\n-            let node = sourceCode.getNodeByRangeIndex(10);\n-\n-            assert.equal(node.type, \"VariableDeclarator\");\n-            node = sourceCode.getNodeByRangeIndex(4);\n-            assert.equal(node.type, \"Identifier\");\n-            assert.property(node, \"parent\");\n-            assert.equal(node.parent.type, \"VariableDeclarator\");\n-            assert.notProperty(node.parent, \"parent\");\n-        });\n-\n     });\n \n     describe(\"isSpaceBetweenTokens()\", () => {"
      }
    ]
  },
  {
    "url": "https://api.github.com/repos/eslint/eslint/issues/591",
    "repository_url": "https://api.github.com/repos/eslint/eslint",
    "labels_url": "https://api.github.com/repos/eslint/eslint/issues/591/labels{/name}",
    "comments_url": "https://api.github.com/repos/eslint/eslint/issues/591/comments",
    "events_url": "https://api.github.com/repos/eslint/eslint/issues/591/events",
    "html_url": "https://github.com/eslint/eslint/pull/591",
    "id": 27024961,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MTIyNTM0MDM=",
    "number": 591,
    "title": "add `npm run profile`.",
    "user": {
      "login": "chrisdickinson",
      "id": 37303,
      "node_id": "MDQ6VXNlcjM3MzAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/37303?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chrisdickinson",
      "html_url": "https://github.com/chrisdickinson",
      "followers_url": "https://api.github.com/users/chrisdickinson/followers",
      "following_url": "https://api.github.com/users/chrisdickinson/following{/other_user}",
      "gists_url": "https://api.github.com/users/chrisdickinson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chrisdickinson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chrisdickinson/subscriptions",
      "organizations_url": "https://api.github.com/users/chrisdickinson/orgs",
      "repos_url": "https://api.github.com/users/chrisdickinson/repos",
      "events_url": "https://api.github.com/users/chrisdickinson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chrisdickinson/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 829215248,
        "node_id": "MDU6TGFiZWw4MjkyMTUyNDg=",
        "url": "https://api.github.com/repos/eslint/eslint/labels/archived%20due%20to%20age",
        "name": "archived due to age",
        "color": "eeeeee",
        "default": false,
        "description": "This issue has been archived; please open a new issue for any further discussion"
      }
    ],
    "state": "closed",
    "locked": true,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2014-02-06T03:36:56Z",
    "updated_at": "2018-02-07T02:25:44Z",
    "closed_at": "2014-02-06T04:00:58Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "draft": false,
    "pull_request": {
      "url": "https://api.github.com/repos/eslint/eslint/pulls/591",
      "html_url": "https://github.com/eslint/eslint/pull/591",
      "diff_url": "https://github.com/eslint/eslint/pull/591.diff",
      "patch_url": "https://github.com/eslint/eslint/pull/591.patch",
      "merged_at": "2014-02-06T04:00:58Z"
    },
    "body": "- This should open up a new window (ideally Chrome).\n- Pop open the Dev Tools. Click on the Profile tab.\n- Hit escape to view the console as well.\n- Once the profile \"all\" is complete, you should be able to inspect the run.\n\nOf note: V8 has a sampling profiler -- so if the stacks look a bit odd, it's usually\nbecause the sampling caught at a weird moment. By default the benchmark is configured\nto run each of:\n1. Large: Unminified, concatenated JSHint codebase.\n2. Medium: Unminified, concatenated jQuery 2.1.0 codebase.\n3. Small: Unminified, concatenated Knockout codebase.\n\n---\n\nThe Chrome dev tools are pretty awesome for inspecting where your JS is spending the most time:\n\nIt can show you what functions are called the most / take the most time out of a run & reasons they haven't been optimized:\n\n![heavy view](https://f.cloud.github.com/assets/37303/2095270/0bcd55fa-8ee0-11e3-8550-b2a211e6b1f6.png)\n\nAs well as a flamegraph:\n\n![flamegraph](https://f.cloud.github.com/assets/37303/2095273/3135081a-8ee0-11e3-9b42-60e8a4f056d4.png?bustcache)\n",
    "reactions": {
      "url": "https://api.github.com/repos/eslint/eslint/issues/591/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "timeline_url": "https://api.github.com/repos/eslint/eslint/issues/591/timeline",
    "performed_via_github_app": null,
    "state_reason": null,
    "score": 1,
    "files": [
      {
        "sha": "60acf19a3db3f620745801c4787a8081d4239474",
        "filename": "package.json",
        "status": "modified",
        "additions": 6,
        "deletions": 2,
        "changes": 8,
        "blob_url": "https://github.com/eslint/eslint/blob/282cb3524d478460bcfbde49003e03662a43581f/package.json",
        "raw_url": "https://github.com/eslint/eslint/raw/282cb3524d478460bcfbde49003e03662a43581f/package.json",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/package.json?ref=282cb3524d478460bcfbde49003e03662a43581f",
        "patch": "@@ -14,7 +14,8 @@\n     \"minor\": \"node Makefile.js minor\",\n     \"major\": \"node Makefile.js major\",\n     \"gensite\": \"node Makefile.js gensite\",\n-    \"browserify\": \"node Makefile.js browserify\"\n+    \"browserify\": \"node Makefile.js browserify\",\n+    \"profile\": \"beefy tests/bench/bench.js --open -- -t brfs -t ./tests/bench/xform-rules.js\"\n   },\n   \"files\": [\n     \"LICENSE\",\n@@ -49,7 +50,10 @@\n     \"browserify\": \"~3.20.0\",\n     \"mocha-phantomjs\": \"~3.3.1\",\n     \"phantomjs\": \"~1.9.2-6\",\n-    \"eslint-tester\": \"latest\"\n+    \"eslint-tester\": \"latest\",\n+    \"brfs\": \"0.0.9\",\n+    \"through\": \"~2.3.4\",\n+    \"beefy\": \"~1.0.0\"\n   },\n   \"keywords\": [\n     \"ast\","
      },
      {
        "sha": "bf2f12edd16c48792c6d4d14c95c40a67d5a107c",
        "filename": "tests/bench/bench.js",
        "status": "added",
        "additions": 38,
        "deletions": 0,
        "changes": 38,
        "blob_url": "https://github.com/eslint/eslint/blob/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Fbench.js",
        "raw_url": "https://github.com/eslint/eslint/raw/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Fbench.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Fbench.js?ref=282cb3524d478460bcfbde49003e03662a43581f",
        "patch": "@@ -0,0 +1,38 @@\n+var eslint = require(\"../../lib/eslint\"),\n+    fs = require(\"fs\");\n+\n+var config = require(\"../../conf/eslint.json\");\n+\n+var large = fs.readFileSync(__dirname + \"/large.js\", \"utf8\"), \n+    medium = fs.readFileSync(__dirname + \"/medium.js\", \"utf8\"),\n+    small = fs.readFileSync(__dirname + \"/small.js\", \"utf8\");\n+\n+var runs = {\n+    large: large,\n+    medium: medium,\n+    small: small\n+};\n+\n+benchmark.runs = runs;\n+benchmark(Boolean, 1);\n+\n+function benchmark(grep, times) {\n+    console.profile(\"all\");\n+    for(var key in runs) {\n+        if(grep(key)) {\n+            console.time(key);\n+            console.profile(key);\n+            run(runs[key], times);\n+            console.profileEnd(key);\n+            console.timeEnd(key);\n+        }\n+    }\n+    console.profileEnd(\"all\");\n+}\n+\n+function run(content, times) {\n+    while(times--) {\n+        eslint.reset();\n+        eslint.verify(content, config);\n+    }\n+}"
      },
      {
        "sha": "eb823a10e10834cac9c98028886f404e23100c1e",
        "filename": "tests/bench/large.js",
        "status": "added",
        "additions": 60571,
        "deletions": 0,
        "changes": 60571,
        "blob_url": "https://github.com/eslint/eslint/blob/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Flarge.js",
        "raw_url": "https://github.com/eslint/eslint/raw/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Flarge.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Flarge.js?ref=282cb3524d478460bcfbde49003e03662a43581f"
      },
      {
        "sha": "f7f422773d9dcedcd11869151d7bcf5ade218a2d",
        "filename": "tests/bench/medium.js",
        "status": "added",
        "additions": 9111,
        "deletions": 0,
        "changes": 9111,
        "blob_url": "https://github.com/eslint/eslint/blob/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Fmedium.js",
        "raw_url": "https://github.com/eslint/eslint/raw/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Fmedium.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Fmedium.js?ref=282cb3524d478460bcfbde49003e03662a43581f"
      },
      {
        "sha": "b61cf5c4c780ff951d5a72cf00665a983543bb6f",
        "filename": "tests/bench/small.js",
        "status": "added",
        "additions": 4225,
        "deletions": 0,
        "changes": 4225,
        "blob_url": "https://github.com/eslint/eslint/blob/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Fsmall.js",
        "raw_url": "https://github.com/eslint/eslint/raw/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Fsmall.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Fsmall.js?ref=282cb3524d478460bcfbde49003e03662a43581f"
      },
      {
        "sha": "fa13aa7f77d9b6271b3035d7e5c528023a1bd34e",
        "filename": "tests/bench/xform-rules.js",
        "status": "added",
        "additions": 35,
        "deletions": 0,
        "changes": 35,
        "blob_url": "https://github.com/eslint/eslint/blob/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Fxform-rules.js",
        "raw_url": "https://github.com/eslint/eslint/raw/282cb3524d478460bcfbde49003e03662a43581f/tests%2Fbench%2Fxform-rules.js",
        "contents_url": "https://api.github.com/repos/eslint/eslint/contents/tests%2Fbench%2Fxform-rules.js?ref=282cb3524d478460bcfbde49003e03662a43581f",
        "patch": "@@ -0,0 +1,35 @@\n+module.exports = transform;\n+\n+var fs = require(\"fs\"),\n+    path = require(\"path\"),\n+    through = require(\"through\");\n+    \n+var target = path.resolve(__dirname, \"..\", \"..\", \"lib\", \"load-rules.js\");\n+\n+\n+function transform(filename) {\n+    if(filename === target) {\n+        return through(noop, inject);\n+    }\n+\n+    return through();\n+}\n+\n+function noop() {\n+\n+}\n+\n+function inject() {\n+    var output = \"module.exports = function() {\\n\";\n+    output += \"    var rules = Object.create(null);\\n\";\n+\n+    fs.readdirSync(path.resolve(__dirname, \"..\", \"..\", \"lib\", \"rules\")).forEach(function(filename) {\n+        var basename = path.basename(filename, \".js\");\n+        output += \"    rules[\\\"\" + basename + \"\\\"] = require(\\\"./rules/\" + basename + \"\\\");\\n\";\n+    });\n+\n+    output += \"\\n    return rules;\\n};\";\n+\n+    this.queue(output);\n+    this.queue(null);\n+}"
      }
    ]
  }
]
