[{"url":"https://api.github.com/repos/moment/moment/issues/5744","repository_url":"https://api.github.com/repos/moment/moment","labels_url":"https://api.github.com/repos/moment/moment/issues/5744/labels{/name}","comments_url":"https://api.github.com/repos/moment/moment/issues/5744/comments","events_url":"https://api.github.com/repos/moment/moment/issues/5744/events","html_url":"https://github.com/moment/moment/pull/5744","id":713736736,"node_id":"MDExOlB1bGxSZXF1ZXN0NDk3MDAxOTk5","number":5744,"title":"[misc] optimize for loops","user":{"login":"PulkitAgg","id":17783893,"node_id":"MDQ6VXNlcjE3NzgzODkz","avatar_url":"https://avatars.githubusercontent.com/u/17783893?v=4","gravatar_id":"","url":"https://api.github.com/users/PulkitAgg","html_url":"https://github.com/PulkitAgg","followers_url":"https://api.github.com/users/PulkitAgg/followers","following_url":"https://api.github.com/users/PulkitAgg/following{/other_user}","gists_url":"https://api.github.com/users/PulkitAgg/gists{/gist_id}","starred_url":"https://api.github.com/users/PulkitAgg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PulkitAgg/subscriptions","organizations_url":"https://api.github.com/users/PulkitAgg/orgs","repos_url":"https://api.github.com/users/PulkitAgg/repos","events_url":"https://api.github.com/users/PulkitAgg/events{/privacy}","received_events_url":"https://api.github.com/users/PulkitAgg/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-10-02T16:08:55Z","updated_at":"2020-10-26T09:25:55Z","closed_at":"2020-10-24T02:26:51Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/moment/moment/pulls/5744","html_url":"https://github.com/moment/moment/pull/5744","diff_url":"https://github.com/moment/moment/pull/5744.diff","patch_url":"https://github.com/moment/moment/pull/5744.patch","merged_at":"2020-10-24T02:26:51Z"},"body":"This pull request will improve the performance as I am pre calculating the array length before the for loop execution\r\nFor example\r\n```\r\nlet i, arr = [1,2,3,4,5];\r\nfor(i = 0; i< arr.length; i++) {\r\n    console.log(i)\r\n}\r\n```\r\narr.length will execute in each iteration which slows our execution. For this I just pre calculate the length and use that variable in each iteration like\r\n```\r\nlet i, arr = [1,2,3,4,5], arrLen = arr.length;\r\nfor(i = 0; i< arrLen; i++) {\r\n    console.log(i)\r\n}\r\n```\r\n\r\nI am also attachig the test suite case run time which is decrease by 610ms after changes\r\n\r\nBefore\r\n<img width=\"442\" alt=\"Test_Case_Run_Time_Before_Code_Update\" src=\"https://user-images.githubusercontent.com/17783893/94944851-79b0df80-04f7-11eb-8061-2a98833d6208.png\">\r\n\r\nAfter\r\n<img width=\"426\" alt=\"Test_Case_Run_Time_After_Code_Update\" src=\"https://user-images.githubusercontent.com/17783893/94944862-7ddcfd00-04f7-11eb-8abf-2b6e5b3240fc.png\">\r\n\r\n","reactions":{"url":"https://api.github.com/repos/moment/moment/issues/5744/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/moment/moment/issues/5744/timeline","performed_via_github_app":null,"state_reason":null,"score":1},{"url":"https://api.github.com/repos/moment/moment/issues/4338","repository_url":"https://api.github.com/repos/moment/moment","labels_url":"https://api.github.com/repos/moment/moment/issues/4338/labels{/name}","comments_url":"https://api.github.com/repos/moment/moment/issues/4338/comments","events_url":"https://api.github.com/repos/moment/moment/issues/4338/events","html_url":"https://github.com/moment/moment/pull/4338","id":278321022,"node_id":"MDExOlB1bGxSZXF1ZXN0MTU1NzU3MTY4","number":4338,"title":"[bugfix] Fix startOf/endOf DST issues while boosting performance","user":{"login":"ashsearle","id":1166814,"node_id":"MDQ6VXNlcjExNjY4MTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1166814?v=4","gravatar_id":"","url":"https://api.github.com/users/ashsearle","html_url":"https://github.com/ashsearle","followers_url":"https://api.github.com/users/ashsearle/followers","following_url":"https://api.github.com/users/ashsearle/following{/other_user}","gists_url":"https://api.github.com/users/ashsearle/gists{/gist_id}","starred_url":"https://api.github.com/users/ashsearle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashsearle/subscriptions","organizations_url":"https://api.github.com/users/ashsearle/orgs","repos_url":"https://api.github.com/users/ashsearle/repos","events_url":"https://api.github.com/users/ashsearle/events{/privacy}","received_events_url":"https://api.github.com/users/ashsearle/received_events","type":"User","site_admin":false},"labels":[{"id":313210217,"node_id":"MDU6TGFiZWwzMTMyMTAyMTc=","url":"https://api.github.com/repos/moment/moment/labels/Pending%20Next%20Release","name":"Pending Next Release","color":"009800","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":14,"created_at":"2017-12-01T00:45:33Z","updated_at":"2020-06-05T07:37:45Z","closed_at":"2019-01-19T02:09:46Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"draft":false,"pull_request":{"url":"https://api.github.com/repos/moment/moment/pulls/4338","html_url":"https://github.com/moment/moment/pull/4338","diff_url":"https://github.com/moment/moment/pull/4338.diff","patch_url":"https://github.com/moment/moment/pull/4338.patch","merged_at":"2019-01-19T02:09:45Z"},"body":"These changes to `startOf` and `endOf` fix several DST-related issues:\r\n- avoid using setHours/setMinutes/setSeconds - fixes #1990, fixes #2749, fixes #3580\r\n- use `Date.UTC` / `new Date` for units bigger than hours - fixes #3132, fixes #4152\r\n\r\nAdditionally, the changes supersede these pull requests: #3620, #4164 and #4254 \r\n\r\nBenchmark results\r\n\r\n| Benchmark | moment 2.19.3 | this PR | improvement |\r\n| --- | --- | --- | --- |\r\n| startOf second | 2,598,171 ops/sec ±1.24% | 5,322,216 ops/sec ±1.56% | 2.0x |\r\n| startOf minute | 1,606,046 ops/sec ±0.98% | 7,397,801 ops/sec ±0.92% | 4.6x |\r\n| startOf hour | 1,069,176 ops/sec ±0.96% | 5,015,984 ops/sec ±0.91%   | 4.6x |\r\n| startOf date | 811,815 ops/sec ±1.08% | 1,162,031 ops/sec ±0.89%     | 1.4x |\r\n| startOf day | 827,911 ops/sec ±0.83% | 1,170,806 ops/sec ±1.25%      | 1.4x |\r\n| startOf isoWeek | 274,302 ops/sec ±1.06% | 973,431 ops/sec ±1.09%    | 3.5x |\r\n| startOf week | 298,240 ops/sec ±1.00% | 1,188,010 ops/sec ±0.94%     | 3.9x |\r\n| startOf month | 653,227 ops/sec ±0.85% | 1,447,224 ops/sec ±0.76%    | 2.2x |\r\n| startOf quarter | 381,496 ops/sec ±0.85% | 1,221,562 ops/sec ±0.93%  | 3.2x |\r\n| startOf year | 425,796 ops/sec ±0.98% | 2,047,534 ops/sec ±1.02%     | 4.8x |\r\n| endOf second | 200,544 ops/sec ±0.92% | 5,496,719 ops/sec ±1.00%     | 27.4x |\r\n| endOf minute | 190,097 ops/sec ±1.02% | 6,600,219 ops/sec ±0.94%     | 34.7x |\r\n| endOf hour | 331,129 ops/sec ±0.86% | 4,612,042 ops/sec ±0.88%       | 13.9x |\r\n| endOf date | 249,577 ops/sec ±1.10% | 1,239,091 ops/sec ±0.96%       | 4.9x  |\r\n| endOf day | 251,496 ops/sec ±1.01% | 1,240,042 ops/sec ±1.35%        | 4.9x  |\r\n| endOf isoWeek | 160,238 ops/sec ±1.73% | 917,050 ops/sec ±0.85%      | 5.7x  |\r\n| endOf week | 174,334 ops/sec ±2.02% | 1,216,138 ops/sec ±0.88%       | 6.9x  |\r\n| endOf month | 200,123 ops/sec ±1.24% | 1,480,412 ops/sec ±2.05%      | 7.3x  |\r\n| endOf quarter | 159,346 ops/sec ±0.99% | 1,165,512 ops/sec ±1.02%    | 7.3x  |\r\n| endOf year | 165,736 ops/sec ±1.70% | 2,026,810 ops/sec ±1.67%       | 12.2x |\r\n\r\nAdditionally, fixed one more bug: `moment('0000-02-29')` was created in year 1900 then reverted to year 0.  Unfortunately Feb 29th doesn't exist in 1900, so the moment ended up as `0000-03-01` instead.\r\n\r\nNew tests have been added to `start_end_of.js` that would have failed in earlier releases.","reactions":{"url":"https://api.github.com/repos/moment/moment/issues/4338/reactions","total_count":7,"+1":0,"-1":0,"laugh":0,"hooray":7,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/moment/moment/issues/4338/timeline","performed_via_github_app":null,"state_reason":null,"score":1}]